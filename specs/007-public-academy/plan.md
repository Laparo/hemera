# Implementation Plan: Public Academy (007)

**Branch**: `007-public-academy` | **Date**: 2025-10-23 | **Spec**:
/Users/Zauberflocke/Documents/GitHub/hemera/specs/007-public-academy/spec.md | **Input**: Feature
specification from `/specs/007-public-academy/spec.md`

## Execution Flow (/plan command scope)

```text
1. Load feature spec from Input path → OK
2. Fill Technical Context (scan for NEEDS CLARIFICATION) → No open markers
3. Fill the Constitution Check section based on constitution → Done
4. Evaluate Constitution Check → PASS (notes below)
5. Execute Phase 0 → research.md → Done
6. Execute Phase 1 → contracts, data-model.md, quickstart.md → Done
7. Re-evaluate Constitution Check → PASS
8. Plan Phase 2 → Describe task generation approach below
9. STOP - Ready for /tasks command (tasks.md generated here per prompt override)
```

## Summary

Public Academy pages provide a course overview and details with internal booking initiation. Prices
are public (gross, DE/EUR), availability derives from internal capacity minus (PAID|PENDING)
bookings, waitlist and filters are out of scope for MVP.

## Technical Context

- Language/Version: TypeScript, Next.js (App Router), Node 22.x
- Primary Dependencies: Next.js, Prisma, Clerk (auth), Playwright (E2E), MUI, Vercel Postgres
- Storage: PostgreSQL via Prisma
- Testing: Playwright for E2E; unit tests TBD for components/services
- Target Platform: Web app on Vercel (Preview/Prod)
- Project Type: Web (frontend + API routes)
- Performance Goals: Fast SSR for course list; acceptable client rendering on detail
- Constraints: Single-locale (DE/EUR), public prices gross, internal booking flow
- Scale/Scope: MVP for public discovery + booking initiation

## Constitution Check

- Test-First Development: E2E specs exist for course list/detail and sold-out state; contract tests
  not yet added (OK for MVP plan; follow-up in tasks)
- Code Quality & Formatting: TypeScript strict, ESLint/Prettier in place (to be honored)
- Deployment Standards: GitHub Actions/Vercel workflows mandated; manual CLI deploys prohibited
  (follow in CI)
- Error Handling & Observability: Rollbar is mandatory for production; ensure API routes use
  structured logging (follow-up tasks)
- Authentication & Security: Clerk is used; public endpoints must avoid leaking PII

Gate: PASS with follow-ups captured in tasks.

## Project Structure

### Documentation (this feature)

```text
specs/007-public-academy/
├── plan.md
├── research.md
├── data-model.md
├── quickstart.md
├── contracts/
│   ├── README.md
│   └── openapi.yaml
└── tasks.md  (generated by this run per prompt override)
```

### Source Code (repository root)

```text
app/            # Next.js App Router (pages, API routes)
components/     # UI components (e.g., CourseDetail)
lib/            # services, prisma client, SEO schemas
prisma/         # schema + seeds
tests/e2e/      # Playwright tests
```

**Structure Decision**: Web application (Next.js App Router + API routes) with Prisma/Postgres,
Clerk auth.

## Phase 0: Outline & Research

See `research.md` (booking flow, pricing, availability, SEO) – all unknowns resolved for MVP.

## Phase 1: Design & Contracts

- `data-model.md`: Entities Course, Booking, PaymentStatus with derived availability
- `contracts/openapi.yaml`: GET /api/courses, GET /api/courses/{id}
- `quickstart.md`: Local run, seed, E2E execution

Post-Design Constitution Check: PASS (Rollbar, contract tests remain follow-ups)

## Phase 2: Task Planning Approach

- Generate actionable tasks from functional requirements and design
- Prioritize contract tests (API schemas) and unit tests for key components
- Ensure deployment workflow validations align with Constitution (Rollbar, CI-only deploys)

## Complexity Tracking

| Violation | Why Needed | Simpler Alternative Rejected Because |
| --------- | ---------- | ------------------------------------ |
| None      | —          | —                                    |

## Progress Tracking

**Phase Status**:

- [x] Phase 0: Research complete (/plan command)
- [x] Phase 1: Design complete (/plan command)
- [x] Phase 2: Task planning described
- [ ] Phase 3: Tasks generated (/tasks command) – created here per prompt override
- [ ] Phase 4: Implementation complete
- [ ] Phase 5: Validation passed

**Gate Status**:

- [x] Initial Constitution Check: PASS
- [x] Post-Design Constitution Check: PASS
- [x] All NEEDS CLARIFICATION resolved
- [x] Complexity deviations documented (none)
